<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Download YouTube Video</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h2>YouTube Video Downloader</h2>
    <input type="text" id="Url" placeholder="Nh·∫≠p link YouTube" style="width: 80%;" />
    <button onclick="getVideoInfo()">L·∫•y th√¥ng tin</button>
    
    <div id="Information" style="margin-top: 20px;"></div>

    <script>
        function getVideoInfo() {
            let videoUrl = document.getElementById("Url").value.trim();
            if (!videoUrl) {
                alert("Vui l√≤ng nh·∫≠p link video facebook!");
                return;
            }

            const settings = {
                async: true,
                crossDomain: true,
                url: 'https://facebook17.p.rapidapi.com/api/facebook/links',
                method: 'POST',
                headers: {
                    'x-rapidapi-key': '23440d752fmsh0bce66bf6c5a2c0p1486cfjsn35a15b05da7d',
                    'x-rapidapi-host': 'facebook17.p.rapidapi.com',
                    'Content-Type': 'application/json'
                },
                processData: false,
                data: JSON.stringify({ url: videoUrl })
            };

            $.ajax(settings).done(function (response) {
                if (response && response.length > 0) { // Ki·ªÉm tra xem response c√≥ d·ªØ li·ªáu kh√¥ng
                    let data = response[0]; // L·∫•y ph·∫ßn t·ª≠ ƒë·∫ßu ti√™n trong m·∫£ng

                    let videoHtml = `
                        <h3>Resource ID: ${data.resourceId}</h3>
                        <img src="${data.pictureUrl}" alt="Video Thumbnail" style="width:300px; display:block; margin-bottom:10px;">
                    `;

                    if (data.urls && data.urls.length > 0) { // Ki·ªÉm tra n·∫øu c√≥ danh s√°ch URL video
                        data.urls.forEach((media) => {
                            videoHtml += `
                                <div style="margin-bottom: 20px;">
                                    <button onclick="downloadVideo('${media.url}', '${data.resourceId}_${media.subName}.${media.extension}')">
                                        üì• T·∫£i v·ªÅ ${media.subName}
                                    </button>
                                </div>
                            `;
                        });
                    } else {
                        videoHtml += "<p>Kh√¥ng t√¨m th·∫•y video n√†o.</p>";
                    }

                    document.getElementById("Information").innerHTML = videoHtml;
                } else {
                    alert("Kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu. Vui l√≤ng ki·ªÉm tra l·∫°i link!");
                }
            }).fail(function () {
                alert("L·ªói khi l·∫•y d·ªØ li·ªáu. Ki·ªÉm tra API key ho·∫∑c th·ª≠ l·∫°i sau.");
            });

        }

        // H√†m t·∫£i video m√† kh√¥ng chuy·ªÉn trang
        function downloadVideo(videoUrl, filename) {
            fetch(videoUrl)
                .then(response => response.blob()) // Chuy·ªÉn d·ªØ li·ªáu th√†nh file
                .then(blob => {
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement("a");
                    a.href = url;
                    a.download = filename;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url); // Gi·∫£i ph√≥ng b·ªô nh·ªõ
                })
                .catch(error => {
                    console.error("L·ªói t·∫£i video:", error);
                    alert("L·ªói khi t·∫£i video. Vui l√≤ng th·ª≠ l·∫°i!");
                });
        }
    </script>
</body>
</html>
